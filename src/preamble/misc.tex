% see http://tex.stackexchange.com/questions/20890/define-an-escape-underscore-environment
\makeatletter
\DeclareRobustCommand*{\escapeus}[1]{%
	\begingroup\@activeus\scantokens{#1\endinput}\endgroup}
\begingroup\lccode`\~=`\_\relax
\lowercase{\endgroup\def\@activeus{\catcode`\_=\active \let~\_}}
\makeatother

\DeclareRobustCommand{\run}[1]{\texttt{\escapeus{#1}}}
\newcommand{\grid}[1]{\run{#1}}

\DefineBibliographyStrings{english}{%
	backrefpage = {Cited on p.~},
	backrefpages = {Cited on pp.~}
}

\newcommand{\figref}[1]{Fig.\ \ref{#1}}
\newcommand{\tabref}[1]{Table \ref{#1}}
\newcommand{\secref}[1]{\textsection\,\ref{#1}}
\newcommand{\chapref}[1]{Chapter \ref{#1}}
\newcommand{\appendixref}[1]{Appendix \ref{#1}}
\newcommand{\listingref}[1]{Code Listing \ref{#1}}

\MakeRobust{\eqref}
\MakeRobust{\figref}
\MakeRobust{\tabref}
\MakeRobust{\chapref}
\MakeRobust{\appendixref}
\MakeRobust{\listingref}

\newcommand{\ie}{i.\,e., }
\newcommand{\Ie}{I.\,e., }
\newcommand{\eg}{e.\,g.\ }
\newcommand{\Eg}{E.\,g.\ }
\newcommand{\cf}{cf.\ }
\newcommand{\Cf}{Cf.\ }

\newcommand{\rn}[1]{%
	\textup{\uppercase\expandafter{\romannumeral#1}}%
}

\newcommand{\orderof}[1]{\mathcal{O}\left(#1\right)}
\newcommand{\curl}{\text{curl}}
\newcommand{\divergence}{\text{div}}
\newcommand{\dx}[1]{~\text{d}#1}
\newcommand{\Ddx}[1][]{\frac{\text{D}#1}{\text{d}t}}
\newcommand{\mean}[1]{\langle #1 \rangle}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\updel}{\mathop{}\!\upDelta}

\DeclareSIUnit\sv{Sv}
\DeclareSIUnit\year{y}
\DeclareSIUnit\permille{\text{\textperthousand}}

\newcommand{\oldand}{\textsw{\& }}
\newcommand{\work}[1]{\textsw{#1}}

\DeclareFieldFormat*{citetitle}{\work{#1}}
\newcommand{\citebook}[1]{\citetitle{#1} \citep{#1}}